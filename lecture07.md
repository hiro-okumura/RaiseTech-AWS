# 第 7 回講義のまとめと感想

## 第六回講義までに構築したアプリケーションの脆弱性と対応を考えてみる

### NAT ゲートウェイを配置する

- 今回作成した RDS はプライベートサブネットに配置されており、踏み台サーバーから SSH 接続を経由してアクセスしている。データベース層が外部と通信する必要がある場合（OS の更新やパッチ適用）に、NAT ゲートウェイを設置してアウトバンド通信のみを許可することで、より安全にインターネットへと通信を通せる。

### HTTP 通信を HTTPS 通信に変える

- 現在 80 番ポートを開放しているところを、443 番ポート のみを許可するようにセキュリティグループを置き換える。
- HTTP 通信のリクエストを HTTPS 通信へとリダイレクトする ALB のリスナールールを設定する。
- HTTPS 通信を適用するためには、SSL 証明書が必要となる。通信の暗号化を確立したりデータの改ざんを防ぐ。
  - ACM で発行した SSL 証明書を EC2 に適用する場合は、ALB にアタッチして経由させる。

### DDoS 攻撃を防ぐ

- AWS WAF のウェブ ACL を使って 特定 IP アドレスからのアクセスをブロックしたり、上限を設ける。
- より大規模な DDoS 攻撃を防ぐには AWS Shield Advanced を利用して SRT チームのサポートを得る。利用料が高額だが、DDoS 攻撃のリクエストに対するコストは補償される。

### アクセスキーの流出を防ぐ。

- KMS や AWS Secrets Manager などの AWS が提供している認証情報を安全に管理するサービスを使う。
- IAM ロールなどの流出するリスクがより低い手段が他にないか検討する。
- アクセスキー自体を発行しないようにして、リスクそのものを回避する。発行するにしても権限の範囲を狭くしてリスクを減らす。例えば、ReadOnly にする等。

## 学んだことのメモ

- アプリケーションやインフラに対するセキュリティリスクだけでなく、事業責任者とセキュリティについて話し合って認識を擦り合わせることでリスクの低減を計ることも必要である。
- 非営利団体である OWASP がとくに重大な 10 個のセキュリティインシデントについてまとめているため、必要に応じて参照する。
  - [OWASP TOP 10 のリンク（日本語版）](https://github.com/owasp-ja/Top10/blob/master/2021/docs/index.ja.md)
- IPA（独立処理推進機構）が公表する共通脆弱性評価システムを参考にする。CVSS のデータベースを日本では JVN と呼ぶ。
  - [JVN 脆弱性レポートの読み方](https://jvn.jp/nav/jvnhelp.html)

## 感想

- セキュリティに関する現象は実務現場で実際に遭遇しない限り理解が進みにくいと感じましたが、Inspector に自動修復機能が無いという情報は、SAA を取得する際に本試験で出題があったので、AWS が重要視している事だと強く認識できました。
- 認証情報については、実際に講義の中で IAM ユーザーのアクセスキーと環境変数を記述したので身近にあるリスクとして感じられました。
- AWS Secrets Manager は、自動ローテーション機能の有無で Systems Manager と比較されることがあったので、要件に応じて最適なサービスを選択・提案できるようになる事を目指すことが極めて重要だと思いました。
